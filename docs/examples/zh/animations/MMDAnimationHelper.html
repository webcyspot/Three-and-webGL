<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<base href="../../" />
		<script src="list.js"></script>
		<script src="page.js"></script>
		<link type="text/css" rel="stylesheet" href="page.css" />
	</head>
	<body>
		<h1>[name]</h1>

		<p class="desc"> 用于 <a href="http://www.geocities.jp/higuchuu4/index_e.htm"><em>MMD</em></a> 资源的动画助手. <br /><br />
		[name] 处理由 [page:MMDLoader]加载的MMD资产，其中MMD 特殊功能为 IK, Grant, and Physics.
		它使用在内部使用 [page:CCDIKSolver] 和 [page:MMDPhysics].
		</p>

		<h2>Example</h2>

		<code>
		// Instantiate a helper
		var helper = new THREE.MMDAnimationHelper();

		// Load MMD resources and add to helper
		new THREE.MMDLoader().loadWithAnimation(
			'models/mmd/miku.pmd',
			'models/mmd/dance.vmd',
			function ( mmd ) {

				helper.add( mmd.mesh, {
					animation: mmd.animation,
					physics: true
				} );

				scene.add( mmd.mesh );

				new THREE.AudioLoader().load(
					'audios/mmd/song.mp3',
					function ( buffer ) {

						var listener = new THREE.AudioListener();
						var audio = new THREE.Audio( listener )
							.setBuffer( buffer );

						listener.position.z = 1;

						scene.add( audio );
						scene.add( listener );

					}

				);

			}
		);

		function render() {

			helper.update( clock.getDelta() );
			renderer.render( scene, camera );

		}
		</code>

		[example:webgl_loader_mmd]<br />
		[example:webgl_loader_mmd_pose]<br />
		[example:webgl_loader_mmd_audio]<br />

		<br />
		<hr>

		<h2>Constructor（构造器）</h2>

		<h3>[name]( [param:Object params] )</h3>
		<p>
		[page:Object params] — (可选的)<br />
		<ul>
			<li> [page:Boolean sync] - 添加对象的动画持续时间是否同步. 默认是 true.</li>
			<li> [page:Number afterglow] - 默认是 0.0.</li>
			<li> [page:Boolean resetPhysicsOnLoop] - 默认是 true.</li>
		</ul>
		</p>
		<p>
		新建一个 [name].
		</p>

		<h2>Properties（属性）</h2>

		<h3>[property:Audio audio]</h3>
		<p>添加到助手的 [page:Audio] </p>

		<h3>[property:Camera camera]</h3>
		<p>添加到助手的 [page:Camera]</p>

		<h3>[property:Array meshes]</h3>
		<p>添加到助手的 [page:SkinnedMesh] 数组</p>

		<h3>[property:WeakMap objects]</h3>
		<p>一个[page：WeakMap]，它存储添加到助手的对象及其动画内容. 例如, 你可以用 "helper.objects.get( mesh ).mixer"访问 [page:AnimationMixer] 用以添加 [page:SkinnedMesh] </p>

		<h3>[property:function onBeforePhysics]</h3>
		<p>在[page：SkinnedMesh]的物理计算之前立即执行的可选回调。 使用[page：SkinnedMesh]调用此函数</p>

		<h2>Methods（方法）</h2>

		<h3>[method:MMDAnimationHelper add]( [param:Object3D object], [param:Object params] )</h3>
		<p>
		[page:Object3D object] — [page:SkinnedMesh], [page:Camera], or [page:Audio]<br />
		[page:Object params] — (可选的)<br />
		<ul>
			<li>[page:AnimationClip animation] - 设定到 object的一个 [page:AnimationClip] 或者 [page:AnimationClip]数组 . 仅适用于 [page:SkinnedMesh] 和 [page:Camera]. 默认是 undefined.</li>
			<li>[page:Boolean physics] - 仅适用于 [page:SkinnedMesh]. 是否打开 physics. 默认是 true.</li>
			<li>[page:Integer warmup] - 仅适用于 [page:SkinnedMesh] 当 physics 为 true. Physics 参数. 默认是 60.</li>
			<li>[page:Number unitStep] - 仅适用于 [page:SkinnedMesh] 当 physics 为 true. Physics 参数. 默认是 1 / 65.</li>
			<li>[page:Integer maxStepNum] - 仅适用于 [page:SkinnedMesh] 当 physics 为 true. Physics 参数. 默认是 3.</li>
			<li>[page:Vector3 gravity] - 仅适用于 [page:SkinnedMesh] 当 physics 为 true. Physics 参数. 默认是 ( 0, - 9.8 * 10, 0 ).</li>
			<li>[page:Number delayTime] - 仅适用于 [page:Audio]. 默认是 0.0.</li>
		</ul>
		</p>
		<p>
		添加 [page:SkinnedMesh], [page:Camera], 或者 [page:Audio] 到助手并且设置动画. 添加的对象的动画时间是同步的.
		如果已经添加了摄像机/音频，它将被替换为新的。
		</p>

		<h3>[method:MMDAnimationHelper enable]( [param:string key], [param:Boolean enabled] )</h3>
		<p>
		[page:string key] — 允许的字符串是 'animation', 'ik', 'grant', 'physics', and 'cameraAnimation'.<br />
		[page:Boolean enabled] — true 启用, false 禁用<br />
		</p>
		<p>
		启用/禁用某项动画功能
		</p>

		<h3>[method:MMDAnimationHelper pose]( [param:SkinnedMesh mesh], [param:Object vpd], [param:Object params] )</h3>
		<p>
		[page:SkinnedMesh mesh] —  会变姿势的[page:SkinnedMesh] . 不必加入助手<br />
		[page:Object vpd] — VPD内容由 [page:MMDLoader].loadVPD获取<br />
		[page:Object params] — (可选的)<br />
		<ul>
			<li>[page:Boolean resetPose] - 默认是 true.</li>
			<li>[page:Boolean ik] - 默认是 true.</li>
			<li>[page:Boolean grant] - 默认是 true.</li>
		</ul>
		</p>
		<p>
		在VPD内容指定时更改[page:SkinnedMesh]的姿势 .
		</p>

		<h3>[method:MMDAnimationHelper remove]( [param:Object3D object] )</h3>
		<p>
		[page:Object3D object] — [page:SkinnedMesh], [page:Camera], 或 [page:Audio]<br />
		</p>
		<p>
		 从助手移除一个[page:SkinnedMesh], [page:Camera], 或 [page:Audio] .
		</p>

		<h3>[method:MMDAnimationHelper update]( [param:Nummber delta] )</h3>
		<p>
		[page:Number delta] — 一秒钟数值<br />
		</p>
		<p>
			提前调整时间并更新添加到助手的动画
		</p>

		<h2>Source（来源）</h2>

		[link:https://github.com/mrdoob/three.js/blob/master/examples/js/animation/MMDAnimationHelper.js examples/js/animation/MMDAnimationHelper.js]
	</body>
</html>
